

## Ch06. í”„ë¡œí¼í‹°ì™€ ì´ˆê¸°í™”



### 6-1 í”„ë¡œí¼í‹°ì˜ ì ‘ê·¼ 

#### 0. Intro

- Javaì˜ 'í•„ë“œ' : ë‹¨ìˆœí•œ ë³€ìˆ˜ ì„ ì–¸ -> ì ‘ê·¼ ë©”ì†Œë“œ ë§Œë“¤ì–´ ì£¼ì–´ì•¼í•¨
- Kotlinì˜ 'í”„ë¡œí¼í‹°' : ë³€ìˆ˜ ì„ ì–¸ + ì ‘ê·¼ ë©”ì„œë“œë¥¼ ê°€ì§€ê³  ìˆìŒ



#### 1. ìë°”ì—ì„œ í•„ë“œë¥¼ ì‚¬ìš©í•  ë•Œì˜ ë¬¸ì œì 

1. Java Code

   Javaì˜ classì˜ í•„ë“œì—ì„œ ê°€ì‹œì„± ì§€ì‹œì **Private***ì„ ì‚¬ìš©í•˜ë ¤ë©´

   ì ‘ê·¼ì(ì ‘ê·¼ ë©”ì„œë“œ)ë¼ê³  ë¶ˆë¦¬ëŠ” **Getterì™€ Setter**ë¥¼ ë§Œë“¤ì–´ì•¼í•¨. 

   <u>**ë‹¨ì ) í•„ë“œê°€ ëŠ˜ì–´ë‚ ìˆ˜ë¡ ì ‘ê·¼ ë©”ì„œë“œë„ ë§ì•„ì§€ê¸°ì— ì½”ë“œì˜ ê°€ë…ì„±ì´ ë–¨ì–´ì§.**</u>

   **Private*** : ì™¸ë¶€ í´ë˜ìŠ¤ì—ì„œ ë³€ìˆ˜ ì§ì ‘ ì ‘ê·¼ ë¶ˆê°€

   ```kotlin
   class Person {
   
       private String name;
       private int age;
   
       // ìƒì„±ì
       public Person(String name, int age) {
           this.name = name;
           this.age = age;
       }
       // ê²Œí„°/ì„¸í„°
       public String getName() {					// âœ”, í•„ë“œ ë³€ìˆ˜ typeê³¼ return type í†µì¼
           return name;
       }
   
       public void setName(String name) {			// âœ” í•„ë“œ ë³€ìˆ˜ typeê³¼ ë§¤ê°œë³€ìˆ˜ type í†µì¼
           this.name = name;
       }
   
       // (ìƒëµ) ageì˜ getter settor
   }
   
   class Main {
       public static void main(String[] args) {
           
           Person p1 = new Person("Kildong", 30);
           
           // p1.name = "Dooly"  ì ‘ê·¼ ë¶ˆê°€			// âœ”
           p1.setName("Dooly");
           System.out.println(p1.getName());
           
       }
   }
   ```

   



2. Kotlin ì½”ë“œ

   ê° í”„ë¡œí¼í‹°ì— ê²Œí„°ì™€ ì„¸í„°ê°€ ìë™ìœ¼ë¡œ ë§Œë“¤ì–´ì§

   ```kotlin
   class Person(var name: String, var age: Int)
   ```



#### 2. ì½”í‹€ë¦°ì—ì„œ ê²Œí„°ì™€ ì„¸í„°ê°€ ì‘ë™í•˜ëŠ” ë°©ì‹

```kotlin
// 1. ì£¼ ìƒì„±ìì— 3ê°œì˜ ë§¤ê°œë³€ìˆ˜ ì •ì˜ (ë‚´ë¶€ ì„ ì–¸ ë²„ì „)
class User(_id: Int, _name: String, _age: Int) {
    // í”„ë¡œí¼í‹°
    val id: Int = _id 		
    var name: String = _name 
    var age: Int = _age
}

// 2. ê°„ì†Œí™”ëœ ë²„ì „
class User(val id: Int, var name: String, var age: Int)

fun main( ) {
    val user = User(1, "Sean", 30)
    val name = user.name	 // ê²Œí„°ì— ì˜í•œ ê°’ íšë“
    user.age = 41			 // ì„¸í„°ì— ì˜í•œ ê°’ ì§€ì •
    println("name: $name, ${user.age}")
}
```



**ì—­ì»´íŒŒì¼ ì½”ë“œ í™•ì¸**

1. getName(), setAge()
2. valì˜ ê²½ìš° getterë§Œ
3. varì˜ ê²½ìš° getterì™€ setter ëª¨ë‘
4. ì½”í‹€ë¦°ê³¼ ìë°” ëª¨ë‘ JVMì—ì„œ ë™ì‘í•˜ê¸° ë–„ë¬¸ì— ì½”ë“œì˜ í˜•íƒœê°€ ìœ ì‚¬

![image](https://user-images.githubusercontent.com/59546818/141180910-4b6f3e96-8124-4b89-bf46-28a839f1169e.png)



#### 3. ê¸°ë³¸ ê²Œí„°ì™€ ì„¸í„° ì§ì ‘ ì§€ì •í•˜ê¸°

| ë³€ìˆ˜      | ì„¤ëª…                                                         |
| --------- | ------------------------------------------------------------ |
| **value** | ì„¸í„°ì˜ ë§¤ê°œë³€ìˆ˜ë¡œì¨ ì™¸ë¶€ë¡œë¶€í„° ê°’ì„ ê°€ì ¸ì˜´<br />ë³€ìˆ˜ëª… ë³€ê²½ ê°€ëŠ¥ |
| **field** | í”„ë¡œí¼í‹°ë¥¼ ì°¸ì¡°í•˜ëŠ” ë³€ìˆ˜<br />ë³€ìˆ˜ëª… ë³€ê²½ ë¶ˆê°€ëŠ¥<br />ë³´ì¡°í•„ë“œë¼ê³  ë¶€ë¦„ |

```kotlin
class User(_id: Int, _name: String, _age: Int) {
    
    /* ê¸°ì¡´ ì½”ë“œ 
    val id: Int = _id 		
    var name: String = _name 
    var age: Int = _age       */
    
    // í”„ë¡œí¼í‹°ë“¤
    val id: Int = _id
        get() = field

    var name: String = _name
        get() = field
        set(value) {
            field = value
        }

    var age: Int = _age
        get() = field
        set(value) {
            field = value
        }
}

fun main() {
    val user1 = User(1, "Kildong", 30)
    user1.age = 35 // ì„¸í„°
    println("user1.age = ${user1.age}") // ê²Œí„°
}
```



**ë³´ì¡° í•„ë“œ(Backing Field)ì˜ ì—­í• **

- `get() = field` ëŠ” ê° í”„ë¡œí¼í‹°ì˜ ê°’ì„ ì½ëŠ” íŠ¹ë³„í•œ ì‹ë³„ì

- field ëŒ€ì‹  í”„ë¡œí¼í‹° ì´ë¦„ ì§ì ‘ ì‚¬ìš©ì‹œ stack overflow ë°œìƒ
- field ì‚¬ìš©ì‹œ this.(ë³€ìˆ˜ëª…)ìœ¼ë¡œ ë³€í™˜ë¨ ex. `this.name = value`



#### 4. ì»¤ìŠ¤í…€ ê²Œí„°ì™€ ì„¸í„°ì˜ í™œìš©

ìš©ë„) ë‹¨ìˆœ ê°’ ë°˜í™˜ ì´ì™¸ì˜ ì‘ì—…ì„ í•˜ê³ ì í•  ë•Œ ì‚¬ìš©   ex. ë¬¸ìì—´ ëŒ€ë¬¸ìë¡œ ë³€í™˜

```kotlin
class User(_id: Int, _name: String, _age: Int) {
    val id: Int = _id
    var name: String = _name
        set(value) {							// private set(value) -> ì™¸ë¶€ì—ì„œ í• ë‹¹ ë¶ˆê°€
            println("The name was changed")
            field = value.toUpperCase() 		// ë°›ì€ ì¸ìë¥¼ ëŒ€ë¬¸ìë¡œ ë³€ê²½í•´ í”„ë¡œí¼í‹°ì— í• ë‹¹
        }

    var age: Int = _age
}

fun main() {
    val user1 = User(1, "kildong", 35)
    user1.name = "coco"
    println("user3.name = ${user1.name}")
}
```



**Q. privateì„ ë„£ìœ¼ë©´ ì™¸ë¶€ì—ì„œ í”„ë¡œí¼í‹°ì— ê°’ì„ í• ë‹¹í•  ìˆ˜ ì—†ìŒ? ëª»ì“°ëŠ”ê±°ë©´ setterë¥¼ ì™¸ë§ë“¤ê¹Œ..?**

![image](https://user-images.githubusercontent.com/59546818/141184747-8e098072-68af-42fd-b0ef-3763a5508562.png)



1. **ë³´ì¡° í”„ë¡œí¼í‹°ì˜ ì‚¬ìš©**

   **ë³´ì¡° í•„ë“œ**ë¥¼ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ê²½ìš°ì—ëŠ” (í”„ë¡œí¼í‹°ì˜ ê°’ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ë³€ìˆ˜)

   ì„ì‹œì ìœ¼ë¡œ ì‚¬ìš©í•  í”„ë¡œí¼í‹°ë¥¼ ì„ ì–¸í•´ ë†“ê³  ê²Œí„°ì™€ ì„¸í„°ì—ì„œ í™œìš©.

   ```kotlin
   // ì»¤ìŠ¤í…€ ê²Œí„°/ì„¸í„°ì˜ ì‚¬ìš©
   class User(_id: Int, _name: String, _age: Int) {
       val id: Int = _id
       private var tempName: String? = null				// âœ”
       var name: String = _name
           get() {
               if (tempName == null) tempName = "NONAME"  // âœ”
               return tempName ?: throw AssertionError("Asserted by others")
           }
           set(value) {
               println("The name was changed")
               field = value.toUpperCase() // ë°›ì€ ì¸ìë¥¼ ëŒ€ë¬¸ìë¡œ ë³€ê²½í•´ í”„ë¡œí¼í‹°ì— í• ë‹¹
           }
   
       var age: Int = _age
   }
   
   fun main() {
       val user1 = User(1, "kildong", 35)
       user1.name = ""
       println("user3.name = ${user1.name}")
   }
   ```

   

   1. main() ê°ì²´ ë§Œë“¤ê³  í•„ë“œê°’ ì´ˆê¸°í™”

   2. name = ""     // null

   3. getter í˜¸ì¶œ ê²°ê³¼ ->  NONAME

   4. ê·¸ë˜ì„œ tempNameì´ ë­”ë°?

      -> ì´ë¦„ì´ nullì´ ë˜ëŠ” ê²½ìš°ë¥¼ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ ì„ì‹œì ìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” í”„ë¡œí¼í‹°



â€‹		Q) `user1.name = ""` ì½”ë“œë¥¼ ì‹¤í–‰í•˜ì§€ ì•Šì•˜ë‹¤ë©´?

â€‹		A) `user3.name = NONAME` ê·¸ëŒ€ë¡œ?



2. **í”„ë¡œí¼í‹°ì˜ ì˜¤ë²„ë¼ì´ë”©** 

   - í”„ë¡œí¼í‹°ëŠ” ë””í´íŠ¸ë¡œ ì˜¤ë²„ë¼ì´ë”©í•  ìˆ˜ ì—†ëŠ” **final** í˜•íƒœë¡œ ì„ ì–¸ëœë‹¤.
   - í•˜ìœ„ í´ë˜ìŠ¤ì—ì„œ í”„ë¡œí¼í‹° ì˜¤ë²„ë¼ì´ë”© ê°€ëŠ¥í•˜ê²Œ í•˜ë ¤ë©´ **open** í‚¤ì›Œë“œë¥¼ ì‚¬ìš©í•´ í”„ë¡œí¼í‹°ë¥¼ ì„ ì–¸
   - ìƒìœ„ í”„ë¡œí¼í‹° íƒ€ì…ì´ **val**ì¼ ê²½ìš° **var**ë¡œ ë³€ê²½ ê°€ëŠ¥, ê·¸ ì—­ì€ ë¶ˆê°€
   - opení‚¤ì›Œë“œë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šìœ¼ë©´ ë³€ìˆ˜ ì˜¤ë²„ë¼ì´ë”© ë¶ˆê°€, ì‘ë‹¹ ê²Œí„° ì„¸í„°ë„ ì‚¬ìš© ë¶ˆê°€

   ```kotlin
   open class First {
       open val x: Int = 0				// âœ”
         get() {
             println("First x")
             return field
         }
       val y: Int = 0 					// âœ” open í‚¤ì›Œë“œê°€ ì—†ìœ¼ë©´ final í”„ë¡œí¼í‹°ì„
   }
   
   class Second : First() {
       override val x: Int = 0
         get() { // ë¶€ëª¨ì™€ êµ¬í˜„ì´ ë‹¤ë¦„
             println("Second x")
             return field + 3
         }
       // override val y: Int = 0 		// âœ” ì—ëŸ¬. ì˜¤ë²„ë¼ì´ë”© ë¶ˆê°€
   }
   
   fun main() {
       val second = Second()
       println(second.x) // ì˜¤ë²„ë¼ì´ë”©ëœ ë‘ë²ˆì§¸ í´ë˜ìŠ¤ ê°ì²´ì˜ x
       println(second.y) // ë¶€ëª¨ë¡œ ë¶€í„° ìƒì† ë°›ì€ ê°’
   }
   ```

   

3. **í”„ë¡œí¼í‹°ë¥¼ ì´ìš©í•œ ë‚˜ì´ ì†ì´ê¸° ì˜ˆì œ**

   ```kotlin
   fun main() {
       val kim = FakeAge()
       kim.age = 15
       println("Kim's real age = 15, pretended age = ${kim.age}")
   
       val hong = FakeAge()
       hong.age = 35
       println("Hong's real age = 35, pretended age = ${hong.age}")
   }
   
   class FakeAge {
       var age: Int = 0
           set(value) { // ë‚˜ì´ì— ë”°ë¼ íŒë³„í•˜ëŠ” ì„¸í„°
               field = when {
                   value < 18 -> 18
                   value in 18..30 -> value
                   else -> value - 3
               }
           }
   }
   ```

   



### 6-2 ì§€ì—° ì´ˆê¸°í™”ì™€ ìœ„ì„

ë³´í†µ í´ë˜ìŠ¤ì—ì„œ í”„ë¡œí¼í‹° ìë£Œí˜•ë“¤ì€ nullì„ ê°€ì§ˆ ìˆ˜ ì—†ê¸° ë•Œë¬¸ì— ì´ˆê¸°í™” ê³¼ì •ì´ í•„ìš”í•˜ë‹¤.

ê°ì²´ì˜ ì •ë³´ê°€ ë‚˜ì¤‘ì— ë‚˜íƒ€ë‚˜ëŠ” ê²½ìš° ì§€ì—°ì´ˆê¸°í™” í‚¤ì›Œë“œ(**lateinit**ê³¼ **lazy**)ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.



#### 1. lateinitì„ í†µí•œ ì§€ì—° ì´ˆê¸°í™”

**0) lateinit í‚¤ì›Œë“œ ì‚¬ìš© ì´ìœ **

- íŠ¹ì • ê°ì²´ì— ì˜ì¡´ì„±ì´ ìˆëŠ” ê²½ìš°.	ex) carí´ë˜ìŠ¤ì˜ ì´ˆê¸°í™” ë¶€ë¶„ì´ Engine ê°ì²´ê°€ ìƒì„±ë˜ì§€ ì•ŠìŒ
- ë©”ëª¨ë¦¬ ì ˆì•½ (ë‹¹ì¥ ì‚¬ìš©í•˜ì§€ ì•Šì„ í”„ë¡œí¼í‹°ë¥¼ êµ³ì´ ì´ˆê¸°í™” í•  í•„ìš” ì—†ìŒ)
- ìœ ë‹› í…ŒìŠ¤íŠ¸ì‹œ (ì„ì‹œì ìœ¼ë¡œ ê°ì²´ë¥¼ ìƒì„±ì‹œì¼œì•¼ í•˜ëŠ” ê²½ìš°)



**1) í”„ë¡œí¼í‹° ì§€ì—° ì´ˆê¸°í™” í•˜ê¸°** 

**[Review]** **í”„ë¡œí¼í‹° ì´ˆê¸°í™” ë°©ë²•** 

- ì£¼ìƒì„±ì ì´ˆê¸°í™”
- init ë¸”ë¡ë‚´ì—ì„œ ì´ˆê¸°í™” 
- ë¶€ìƒì„±ì ì´ˆê¸°í™”
- ë§¤ê°œë³€ìˆ˜ default ê°’ ì„¤ì •

**[Background 1]** **lateinitì˜ ì œí•œ**

- varë¡œ ì„ ì–¸ëœ í”„ë¡œí¼í‹°ë§Œ ê°€ëŠ¥í•˜ë‹¤. (ì†¡í˜„ ë³´ê³ ìˆë‚˜?ğŸ‘€)   

  cf. valë¡œ ì„ ì–¸í•˜ê³ ì í•œë‹¤ë©´ lazy ì‚¬ìš©

- í”„ë¡œí¼í‹°ì— ëŒ€í•œ ê²Œí„°ì™€ ì„¸í„°ë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤.

 <img src="https://user-images.githubusercontent.com/59546818/141190874-1b969bf2-d2cc-4dc2-8dc8-c9492cdd6b83.png" alt="image" style="zoom:50%;" />



**[Background 2] `isInitialized` ë©”ì†Œë“œ**

- í”„ë¡œí¼í‹°ê°€ ì´ˆê¸°í™” ë˜ì—ˆëŠ”ì§€ ê²€ì‚¬í•˜ëŠ” ì½”í‹€ë¦° í‘œì¤€ í•¨ìˆ˜ì˜ API
- í”„ë¡œí¼í‹° ì°¸ì¡°ë¥¼ ìœ„í•´ ì½œë¡  2ê°œ ì‚¬ìš©(::)



**lateint í™œìš© ì˜ˆì œ**

âŒ lateinit í”„ë¡œí¼í‹°ë¥¼ ì´ˆê¸°í™” í•˜ì§€ ì•Šê³  ì‚¬ìš©í•œë‹¤ë©´ **UninitializedPropertyAccessException** ë°œìƒ 

```kotlin
class Person {
    lateinit var name: String

    fun test() {
        if(!::name.isInitialized) { // í”„ë¡œí¼í‹°ì˜ ì´ˆê¸°í™” ì—¬ë¶€ íŒë‹¨
            println("not initialized")
        } else {
            println("initialized")
        }
    }
}

fun main() {
    val kildong = Person()
    kildong.test()				// "not initialized"
    kildong.name = "Kildong" 	// (ì§€ì—°ì´ˆê¸°í™”)
    kildong.test()				// "initialized"
    println("name = ${kildong.name}")
}
```



**2) ê°ì²´ ì§€ì—° ì´ˆê¸°í™”**

ë‘˜ ì§¸ ì¤„ì˜ person1 ê°ì²´ëŠ” ìƒì„±ìë¥¼ í†µí•´ ì„ ì–¸ë˜ì§€ ì•Šê³  main()ì—ì„œ ì§€ì—° ì´ˆê¸°í™”

```kotlin
data class Person(var name:String, var age:Int)

lateinit var person1: Person	// ê°ì²´ ìƒì„±ì˜ ì§€ì—° ì´ˆê¸°í™”

fun main() {
    person1 = Person("kildong", 30)
    print(person1.name + " is " + person1.age.toString())
}
```





#### 2. lazyë¥¼ ì‚¬ìš©í•œ ì§€ì—° ì´ˆê¸°í™”

- val ë³€ìˆ˜ë¥¼ ì§€ì—° ì´ˆê¸°í™” í•  ë•Œ ì‚¬ìš© (ì´í›„ ê°’ ìˆ˜ì • ë¶ˆê°€)

- **í”„ë¡œí¼í‹° í˜¸ì¶œ ì‹œì **ì— by lazy{ ... } ì •ì˜ì— ì˜í•´ ë¸”ë¡ ë¶€ë¶„ì˜ **ì´ˆê¸°í™”ë¥¼ ì§„í–‰**í•œë‹¤.



1. **í”„ë¡œí¼í‹° ì§€ì—° ì´ˆê¸°í™” í•˜ê¸°**

   - **lazy**ëŠ” ëŒë‹¤ì‹ìœ¼ë¡œ êµ¬ì„±ë˜ì–´ lazy ì¸ìŠ¤í„´ìŠ¤ ë°˜í™˜ ê°’ì„ ê°€ì§€ëŠ” í•¨ìˆ˜ì´ë‹¤.
   - **by**ëŠ” í”„ë¡œí¼í‹°ë¥¼ ìœ„ì„í•  ë•Œ ì‚¬ìš©í•˜ëŠ” í‚¤ì›Œë“œ

   ```kotlin
   class LazyTest {
       init {
           println("init block") // (2)
       }
   
       val subject by lazy {
           println("lazy initialized") // (6)
           "Kotlin Programming" // (7) lazy ë°˜í™˜ê°’
       }
       fun flow() {
           println("not initialized") // (4)
           println("subject one: $subject") // (5) ìµœì´ˆ ì´ˆê¸°í™” ì‹œì !
           println("subject two: $subject") // (8) ì´ë¯¸ ì´ˆê¸°í™”ëœ ê°’ ì‚¬ìš©
       }
   }
   
   fun main() {
       val test = LazyTest() // (1)
       test.flow() // (3)
   }
   ```

   

2. **ê°ì²´ ì§€ì—° ì´ˆê¸°í™” í•˜ê¸°**

   - ê°ì²´ì˜ í”„ë¡œí¼í‹°ë‚˜ ë©”ì„œë“œê°€ ì ‘ê·¼ë˜ëŠ” ì‹œì ì—ì„œ ì´ˆê¸°í™” ëœë‹¤.
   - by lazyëŠ” ê°ì²´ì˜ ìœ„ì„ì„ ë‚˜íƒ€ë‚¸ë‹¤.
   - lazyëŠ” ë³€ìˆ˜ì— ìœ„ì„ëœ **Lazy ê°ì²´** ìì²´ë¥¼ ë‚˜íƒ€ë‚¸ë‹¤.  -> `${personDelegate.value.name}`

   ```kotlin
   class Person(val name: String, val age: Int)
   
   fun main() {
       var isPersonInstantiated: Boolean = false
   
       val person : Person by lazy {
           isPersonInstantiated = true
           Person("Kim", 23)
       }
       val personDelegate = lazy { Person("Hong", 40) }
   
       println("person Init: $isPersonInstantiated")
       println("personDelegate Init: ${personDelegate.isInitialized()}")
   
       println("person.name = ${person.name}")  // ì´ ì‹œì ì—ì„œ ì´ˆê¸°í™”
       println("personDelegate.value.name = ${personDelegate.value.name}")  // ì´ ì‹œì ì—ì„œ ì´ˆê¸°í™”
   
       println("person Init: $isPersonInstantiated")
       println("personDelegate Init: ${personDelegate.isInitialized()}")
   }
   ```

   

3. **lazy ëª¨ë“œ í™•ì¸í•˜ê¸°**
   - lazy()ëŠ” ë§¤ê°œë³€ìˆ˜ ì—†ëŠ” ëŒë‹¤ì‹ì„ ë°›ì„ ìˆ˜ ìˆìœ¼ë©°, Lazy<T>ë¥¼ ë°˜í™˜í•˜ê¸°ì— ì–´ë–¤ ìë£Œí˜•ì´ë“  ì²˜ë¦¬ê°€ëŠ¥í•˜ë‹¤.
   - lazy()ì˜ ì‹¤í–‰ì€ êµ¬í˜„ë¶€ SynchronizedLazyImpl()ì— ë³´ë‚´ ì²˜ë¦¬í•œë‹¤
   - lazy()ì˜ ì‹¤í–‰ ëª¨ë“œëŠ” 3ê°€ì§€ê°€ ìˆë‹¤
     - SYNCHRONIZED : lockì„ ì‚¬ìš©í•´ ë‹¨ì¼ ìŠ¤ë ˆë“œë§Œì´ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ë³´ì¥í•œë‹¤(ê¸°ë³¸ê°’)
     - PUBLICATION : ì—¬ëŸ¬êµ°ë°ì—ì„œ í˜¸ì¶œë  ìˆ˜ ìˆìœ¼ë‚˜ ì²˜ìŒ ì´ˆê¸°í™” ëœ í›„ ë°˜í™˜ê°’ì„ ì‚¬ìš©í•œë‹¤
     - NONE : lockì„ ì‚¬ìš©í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— ë¹ ë¥´ì§€ë§Œ ë‹¤ì¤‘ ìŠ¤ë ˆë“œê°€ ì ‘ê·¼í•  ìˆ˜ ìˆë‹¤(ê°’ì˜ ì¼ê´€ì„± ë³´ì¥x)



### 3. byë¥¼ ì´ìš©í•œ ìœ„ì„

- í”„ë¡œí¼í‹° ìœ„ì„ì´ë€, í”„ë¡œí¼í‹° ê²Œí„°ì™€ ì„¸í„°ë¥¼ íŠ¹ì • ê°ì²´ì— ìœ„ì„í•˜ê³  ê·¸ ê°ì²´ê°€ ê°’ì„ ì½ê±°ë‚˜ ì“¸ë•Œ ìˆ˜í–‰í•˜ë„ë¡ ë§Œë“œëŠ” ê²ƒ
- by í‚¤ì›Œë“œë¥¼ ì‚¬ìš©í•˜ë©´ í•˜ë‚˜ì˜ í´ë˜ìŠ¤ê°€ ë‹¤ë¥¸ í´ë ˆìŠ¤ì— ìœ„ì„í•˜ë„ë¡ ì„ ì–¸í•˜ì—¬ ì´ì„ëœ í´ë˜ìŠ¤ê°€ ê°€ì§€ëŠ” ë©¤ë²„ë¥¼ ì°¸ì¡° ì—†ì´ í˜¸ì¶œí•  ìˆ˜ ìˆê²Œ ëœë‹¤



1. **í´ë˜ìŠ¤ì˜ ìœ„ì„**

   - ìœ„ì„ì„ ì‚¬ìš©í•˜ëŠ” ì´ìœ ? 

     - ì½”í‹€ë¦°ì˜ í‘œì¤€ ë¼ì´ë¸ŒëŸ¬ë¦¬ëŠ” final í˜•íƒœì˜ í´ë˜ìŠ¤ ì´ë¯€ë¡œ ìƒì†ì´ë‚˜, ì§ì ‘ í´ë˜ìŠ¤ì˜ ê¸°ëŠ¥ í™•ì¥ì´ ì–´ë µë‹¤
     - í•„ìš”í•œ ê²½ìš°ì—ë§Œ ìœ„ì„ì„ í•˜ê²Œë” ìœ ë„í•¨ìœ¼ë¡œì¨ ìƒì†ì— ë”°ë¥¸ ë³µì¡í•œ ë¬¸ì œë¥¼ ë°©ì§€í•œë‹¤

   - ìœ„ì„ì— ëŒ€í•œ ì˜ˆì œ

     - Car by impl : implì€ CarModelì— ìœ„ì„ëœë‹¤.

       íƒ€ì…ì´ Carì´ë¯€ë¡œ íŠ¹ì • ì°¸ì¡° ì—†ì´ Carì˜ ë©¤ë²„ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ 

     - VanImpl / SportImpl : Car ì¸í„°í˜ì´ìŠ¤ë¥¼ ìƒì†ë°›ì•„ êµ¬í˜„í•œë‹¤

     ```kotlin
     interface Car {
         fun go(): String
     }
     
     class VanImpl(val power: String): Car {
         override fun go() = "ëŠ” ì§ì„ ì ì¬í•˜ë©° $power ë§ˆë ¥ì„ ê°€ì§‘ë‹ˆë‹¤."
     }
     
     class SportImpl(val power: String): Car {
         override fun go() = "ëŠ” ê²½ì£¼ìš©ì— ì‚¬ìš©ë˜ë©° $power ë§ˆë ¥ì„ ê°€ì§‘ë‹ˆë‹¤."
     }
     
     class CarModel(val model: String, impl: Car): Car by impl {
         fun carInfo() {
             println("$model ${go()}") // ì°¸ì¡° ì—†ì´ ê° ì¸í„°í˜ì´ìŠ¤ êµ¬í˜„ í´ë˜ìŠ¤ì˜ goë¥¼ ì ‘ê·¼
         }
     }
     
     fun main() {
         val myDamas = CarModel("Damas 2010", VanImpl("100ë§ˆë ¥"))
         val my350z = CarModel("350Z 2008", SportImpl("350ë§ˆë ¥"))
     
         myDamas.carInfo()
         my350z.carInfo()
     }
     ```

     

2. **í”„ë¡œí¼í‹° ìœ„ì„ê³¼ by lazy**

   - lazyì˜ ë™ì‘ ì„¤ëª…
     1. lazy ëŒë‹¤ì‹ì€ ëŒë‹¤ì‹ì„ ì „ë‹¬ë°›ì•„ ì €ì¥í•œ Lazy ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë°˜í™˜í•œë‹¤.
     2. ìµœì´ˆ í”„ë¡œí¼í‹°ì˜ ê²Œí„° ì‹¤í–‰ì€ lazyì— ë„˜ê²¨ì§„ ëŒë‹¤ì‹ì„ ì‹¤í–‰í•˜ê³  ê²°ê³¼ë¥¼ ê¸°ë¡í•œë‹¤.
     3. ì´í›„ í”„ë¡œí¼í‹°ì˜ ê²Œí„° ì‹¤í–‰ì€ ì´ë¯¸ ì´ˆê¸°í™”ë˜ì–´ ê¸°ë¡ëœ ê°’ì„ ë°˜í™˜í•œë‹¤.
   - by lazyì— ì˜í•œ ì§€ì—° ì´ˆê¸°í™”ëŠ” ìŠ¤ë ˆë“œì— ì¡°ê¸ˆ ë” ì•ˆì •ì ìœ¼ë¡œ í”„ë¡œí¼í‹°ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.



3. **observable() í•¨ìˆ˜ì™€ vetoable()í•¨ìˆ˜ì˜ ìœ„ì„**

   - observable() : ì´ ë©”ì†Œë“œëŠ” í”„ë¡œí¼í‹°ë¥¼ ê°ì‹œí•˜ê³  ìˆë‹¤ê°€ íŠ¹ì • ì½”ë“œì˜ ë¡œì§ì—ì„œ ë³€ê²½ì´ ì¼ì–´ë‚  ë•Œ í˜¸ì¶œ

     íŠ¹ì • ë³€ê²½ ì´ë²¤íŠ¸ì— ë”°ë¼ í˜¸ì¶œë˜ë¯€ë¡œ ì½œë°±ì´ë¼ê³ ë„ ë¶€ë¥¸ë‹¤.

   - vetoable() : observableê³¼ ìœ ì‚¬í•˜ë‚˜ ë°˜í™˜ê°’ì— ë”°ë¼ í”„ë¡œí¼í‹° ë³€ê²½ì„ í—ˆìš©í•˜ê±°ë‚˜ ì·¨ì†Œí•  ìˆ˜ ìˆë‹¤.

     (ì§ì—­í•˜ë©´ ê±°ë¶€í•  ìˆ˜ ìˆëŠ”ì´ë¼ëŠ” ì˜ë¯¸ë¼ê³  í•©ë‹ˆë‹¤)

   - ë‘ í•¨ìˆ˜ ëª¨ë‘ ë§¤ê°œë³€ìˆ˜ì— initialValueê°€ ìˆê³ , onChange() ë©”ì†Œë“œë¥¼ ê°€ì§„ë‹¤
   - vetoableì˜ ê²½ìš° onChange()ëŒë‹¤ì‹ ë‚´ë¶€ì—ì„œ ì¡°ê±´ì‹ì„ í†µí•´ ì²˜ë¦¬í•œë‹¤
   - ë‘˜ë‹¤ ì‚¬ìš©ì „ Delegates íŒ¨í‚¤ì§€ ì„í¬íŠ¸ í•˜ê¸°!

   ![image-20211111080740257](C:\Users\Kim Hyo Rim\AppData\Roaming\Typora\typora-user-images\image-20211111080740257.png)

   

   

4. **observable() í•¨ìˆ˜ì˜ ì‚¬ìš© ë°©ë²•**

   - Delegates í´ë˜ìŠ¤ì— êµ¬í˜„ëœ observable ë©”ì†Œë“œëŠ” 2ê°œì˜ ë§¤ê°œë³€ìˆ˜ë¥¼ ê°€ì§„ë‹¤

     1. initialValue : ì´ˆê¸°ê°’ (ë°ì´í„°ë¡œ ë“¤ì–´ì˜¬ ê²ƒ ê°™ì§€ ì•Šì€ ê°’ìœ¼ë¡œ ì§€ì •í•˜ì)
     2. onChange ëŒë‹¤ í•¨ìˆ˜ / 3ê°œì˜ ë§¤ê°œë³€ìˆ˜ë¥¼ ê°€ì§„ë‹¤
        - property
        - oldValue
        - newValue

   - ì˜ˆì œ ì½”ë“œ

     ë§¤ê°œë³€ìˆ˜ì¸ ëŒë‹¤í•¨ìˆ˜ê°€ ë¶„ë¦¬ë˜ì–´ ë‚˜ì™€ìˆìŒ

     ```kotlin
     import kotlin.properties.Delegates
     
     class User {
         // observableì€ ê°’ì˜ ë³€í™”ë¥¼ ê°ì‹œí•˜ëŠ” ì¼ì¢…ì˜ ì½œë°± ë£¨í‹´
         var name: String by Delegates.observable("NONAME") {	// initialValue
             prop, old, new -> // í”„ë¡œí¼í‹°, ê¸°ì¡´ê°’, ìƒˆë¡œìš´ ê°’
             println("$old -> $new") // ì´ ë¶€ë¶„ì€ ì´ë²¤íŠ¸ê°€ ë°œìƒí•  ë•Œë§Œ ì‹¤í–‰
         }
     }
     
     fun main() {
         val user = User()
         user.name = "Kildong" // ê°’ì´ ë³€ê²½ë˜ëŠ” ì‹œì ì—ì„œ ì²« ì´ë²¤íŠ¸ ë°œìƒ
         user.name = "Dooly" // ê°’ì´ ë³€ê²½ë˜ëŠ” ì‹œì ì—ì„œ ë‘ ë²ˆì§¸ ì´ë²¤íŠ¸ ë°œìƒ
     }
     ```

   

5. **vetoable() í•¨ìˆ˜ì˜ ì‚¬ìš© ë°©ë²•**

   - ì»¬ë ‰ì…˜ê³¼ ê°™ì´ í° ë°ì´í„°ë¥¼ ë‹¤ë£° ë•Œ ìœ ë¦¬

   - ì˜ˆì œ ì½”ë“œ

   ```kotlin
   import kotlin.properties.Delegates
   
   fun main() {
   
       var max: Int by Delegates.vetoable(0) { // ì´ˆê¸°ê°’ì€ 0
           prop, old, new ->
           new > old // ì¡°ê±´ì— ë§ì§€ ì•Šìœ¼ë©´ ê±°ë¶€ê¶Œ í–‰ì‚¬
       }
   
       println(max) // 0
       max = 10
       println(max) // 10
   
       // ì—¬ê¸°ì„œëŠ” ê¸°ì¡´ê°’ì´ ìƒˆ ê°’ë³´ë‹¤ í¬ë¯€ë¡œ false ë”°ë¼ì„œ 5ë¥¼ ì¬í• ë‹¹ í•˜ì§€ ì•ŠìŒ
       max = 5
       println(max) // 10
   }
   ```

   

   



### 6-3 ì •ì  ë³€ìˆ˜ì™€ ì»´íŒ¨ë‹ˆì–¸ ê°ì²´

ë™ì  ë³€ìˆ˜ë“¤ì€ scopeì´ ì§€ì •ë˜ê¸° ë•Œë¬¸ì— í•´ë‹¹ ë²”ìœ„ë¥¼ ë²—ì–´ë‚˜ë©´ ì‚¬ìš©ì´ ë¶ˆê°€í•˜ë‹¤.

ì´ë¥¼ ì •ì  ë³€ìˆ˜ì™€ ì»´íŒ¨ë‹ˆì–¸ ê°ì²´ë¥¼ í™œìš©í•˜ì—¬ í•´ê²°í•  ìˆ˜ ìˆë‹¤.

í•´ë‹¹ ë³€ìˆ˜ë“¤ì€ í”„ë¡œê·¸ë¨ì„ ì‹¤í–‰í•  ë•Œ **ê³ ì •ì ìœ¼ë¡œ ê°€ì§€ëŠ” ë©”ëª¨ë¦¬**ë¡œ, ê°ì²´ ìƒì„± ì—†ì´ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.



#### 1. ì •ì  ë³€ìˆ˜ì™€ ì»´íŒ¨ë‹ˆì–¸ ê°ì²´

ì •ì  ë³€ìˆ˜ëŠ”, ì¸ìŠ¤í„´ìŠ¤í™”í•  í•„ìš” ì—†ì´ ì‚¬ìš©í•  ìˆ˜ ìˆìœ¼ë©°, ë™ì¼í•œ ì°¸ì¡°ê°’ì„ ê°€ì§„ë‹¤.

ë”°ë¼ì„œ ëª¨ë“  ê°ì²´ì— ì˜ìƒˆ ê³µìœ ë˜ëŠ” íš¨ê³¼ë¥¼ ê°€ì§„ë‹¤

ex. car classì—ì„œ ì°¨ í•˜ë‚˜ë¥¼ ìƒì„±í•  ë•Œë§ˆë‹¤  `int totalCarNum `ì— 1ì„ ë”í•´ ì¤„ ìˆ˜ ìˆë‹¤.



1. **ì»´íŒ¨ë‹ˆì–¸ ê°ì²´ ì‚¬ìš©í•˜ê¸°**

   - static í‚¤ì›Œë“œì™€ ìœ ì‚¬í•œ íš¨ê³¼
   - Companion ê°ì²´ëŠ” ì‹¤ì œ ê°ì²´ì˜ ì‹±ê¸€í†¤ìœ¼ë¡œ ì •ì˜ëœë‹¤
   - **ì‹±ê¸€í†¤ì´ë€** ì „ì—­ë³€ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šê³  ê°ì²´ë¥¼ í•˜ë‚˜ë§Œ ìƒì„±í•˜ë„ë¡ í•˜ë©°, ìƒì„±ëœ ê°ì²´ë¥¼ ì–´ë””ì—ì„œë“ ì§€ ì°¸ì¡°í•  ìˆ˜ ìˆë„ë¡ í•˜ëŠ” ë””ìì¸ íŒ¨í„´ì˜ í•˜ë‚˜ì´ë‹¤.
   - ì˜ˆì œ ì½”ë“œ

   ```kotlin
   class Person {
       var id: Int = 0
       var name: String = "Youngdeok"
       companion object { // ì»´í˜ë‹ˆì–¸ ê°ì²´ì˜ ì •ì˜
           var language: String = "Korean"
           fun work() {
               println("working...")
           }
       }
   }
   
   fun main() {
       println(Person.language)  // ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•˜ì§€ ì•Šê³  ê¸°ë³¸ê°’ ì‚¬ìš©
       Person.language = "English" // ê¸°ë³¸ê°’ ë³€ê²½ ê°€ëŠ¥
       println(Person.language) // ë³€ê²½ëœ ë‚´ìš© ì¶œë ¥
       Person.work() // ë©”ì„œë“œ ì‹¤í–‰
       //println(Person.name) // nameì€ companion objectê°€ ì•„ë‹ˆë¯€ë¡œ ì˜¤ë¥˜
   }
   ```

   



2. **ì½”í‹€ë¦°ì—ì„œ ìë°”ì˜ static ë©¤ë²„ ì‚¬ìš©í•˜ê¸°**

   **Customer.java**

   ```java
   public class Customer {
       public static final String LEVEL = "BASIC";  // static í•„ë“œ
       public static void login() { // static ë©”ì„œë“œ
           System.out.println("Login...");
       }
   }
   ```

   **CustomerAccess.kt**

   ```kotlin
   fun main() {
       println(Customer.LEVEL)
       Customer.login()
   }
   ```



3. **ìë°”ì—ì„œ ì½”í‹€ë¦° ì»´íŒ¨ë‹ˆì–¸ ê°ì²´ ì‚¬ìš©í•˜ê¸°**

   **KCustomer.kt**

   ```kotlin
   class KCustomer {
       companion object {
           const val LEVEL = "INTERMEDIATE"
           @JvmStatic fun login() = println("Login...") // ì–´ë…¸í…Œì´ì…˜ í‘œê¸° ì‚¬ìš©
           @JvmStatic val score = 3
           @JvmField val JOB = KJob()
       }
   }
   
   class KJob {
       var title: String = "Programmer"
   }	
   ```

   **KCustomerAccess.java**

   ```java
   public class KCustomerAccess {
   
       public static void main(String[] args) {
   
           // ì½”í‹€ë¦° ì½”ë“œì˜ KotlinFooì˜ ë©¤ë²„ë¥¼ ì ‘ê·¼
           System.out.println(KCustomer.LEVEL);
           KCustomer.login(); // ì–´ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•  ë•Œ ì ‘ê·¼ ë°©ë²•
           KCustomer.Companion.login();
           // ìœ„ì™€ ë™ì¼í•œ ê²°ê³¼ë¡œ ì–´ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•˜ì§€ ì•Šì„ ë•Œ ì ‘ê·¼ ë°©ë²• âœ”
   
           // KJobì— ëŒ€í•œ ê°ì²´ ìƒì„± í›„ ì ‘ê·¼
           KJob kjob = KCustomer.JOB;
           System.out.println(kjob.getTitle());
   
           // KCostomerë¥¼ í†µí•œ ì ‘ê·¼
           KCustomer.JOB.setTitle("Accountant");
           System.out.println(KCustomer.JOB.getTitle());
       }
   }
   ```

  - const : ì»´íŒŒì¼ ì‹œê°„ì˜ ìƒìˆ˜

  - @JvmStatic : ìë°” ì†ŒìŠ¤ì½”ë“œì—ì„œ Companionì„ ìƒëµí•  ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” ì–´ë…¸í…Œì´ì…˜ âœ”

  - @JvmField : í”„ë¡œí¼í‹°ë¥¼ ìë°”ì—ì„œ ì‚¬ìš©í•˜ê³ ì í•  ê²½ìš°

  - Companion ê°ì²´

    ì™¸ë¶€ í´ë˜ìŠ¤ì—ì„œ private í”„ë¡œí¼í‹°ì—ë„ ì ‘ê·¼í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ìœ í‹¸ë¦¬í‹° í´ë˜ìŠ¤ë¥¼ ë§Œë“œëŠ”ë° ì‚¬ìš© ê°€ëŠ¥





### 2. ìµœìƒìœ„ í•¨ìˆ˜ ì‚¬ìš©í•˜ê¸°

í´ë˜ìŠ¤ ì—†ì´ ë§Œë“¤ë©°, ê°ì²´ ìƒì„± ì—†ì´ë„ main() í•¨ìˆ˜ì—ì„œ ì‹¤í–‰í•  ìˆ˜ ìˆëŠ” í•¨ìˆ˜

```kotlin
@file:JvmName("PKLevel")
package chap06.section3

// íŒ¨í‚¤ì§€ ë ˆë²¨ í•¨ìˆ˜ í˜¹ì€ ìµœìƒìœ„ í•¨ìˆ˜ë¼ê³  í•¨
fun packageLevelFunc() {
    println("Package-Level Function")
}

fun main() {
    packageLevelFunc()
}
```

- ì—­ì»´íŒŒì¼ í•´ë³´ë©´ ìµœìƒìœ„ í•¨ìˆ˜ëŠ” JVMì—ì„œ **staic**ìœ¼ë¡œ ì„ ì–¸ë˜ì–´ ìˆìŒì„ ì•Œ ìˆ˜ ìˆë‹¤. (ê°ì²´ ìƒì„± ì—†ì´ ì‚¬ìš© ê°€ëŠ¥)
- ì—­ì»´íŒŒì¼ëœ ìë°”ì½”ë“œë¥¼ ë³´ë©´ **PackageLevelFuncktionKt** í´ë˜ìŠ¤ê°€ ìƒì„±ë˜ì–´ ìˆìŒ
- ì ‘ê·¼í•  í´ë˜ìŠ¤ë¥¼ ë°”ê¾¸ê³  ì‹¶ë‹¤ë©´ `@file:JvmName("PKLevel")` ìµœìƒë‹¨ì— ì¶”ê°€.





### 3. Objectì™€ ì‹±ê¸€í†¤

ë‚´ìš©ì´ ì¡°ê¸ˆ ë³€ê²½ëœ í´ë˜ìŠ¤ë¥¼ ìƒì„±í•˜ê³  ì‹¶ì„ ë•Œ

- Java : ìµëª… ë‚´ë¶€ í´ë˜ìŠ¤
- Kotlin : object í‘œí˜„ì‹ì´ë‚˜ object ì„ ì–¸

